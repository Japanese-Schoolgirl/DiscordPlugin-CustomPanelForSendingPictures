# Введение:
Этот плагин был написан для себя и людей, с которыми я общаюсь. Но поскольку плагин может быть полезен ещё кому-то я также выкладываю его здесь. При желании переделать этот плагин (а учитывая мою неопытность, это вероятно даже нужно) проверьте также файл лицензии.<br />

P.S. Я очень редко пользуюсь GitHub'ом, так что для подобного проекта это мой первый опыт. Не удивляйтесь каким-нибудь нелепостям с commit'ами и т.д.<br />

# Описание плагина:
Этот плагин добавляет в меню специальную кнопку "Картинки" справа от кнопки выбора эмодзи. Нажатие по этой кнопке загружает панель, содержимое которой берётся из специальной папки, которую создаёт этот плагин. В папке сканируются следующие типы файлов: ".jpg", ".jpeg", ".bmp", ".png", ".webp", ".gif", ".src", ".sent".<br />
Файлы типа ".src" и ".sent" являются JSON файлами и они содержат ссылку на веб файл (пример содержимого: "https://i.imgur.com/l5Jf0VP.png").<br />
По итогу сканирования в панели будут отображены привью всех ваших файлов из папки. Нажав по файлу в этой панели вы сразу же отправите файл картинки (или ссылку картинки, в случае для ".src" и ".sent") в чат Дискорда, который у вас открыт.<br />
Файлы типа ".sent" в панели заменяют файл с идентичным названием и расширением файла. Файлы ".sent" будут автоматически генерироваться при отправке локальных файлов и использоваться, если включена соответствующая настройка.<br />
С версии 0.0.7 теперь этот **плагин будет находить и сканировать подпапки, находящиеся в главной папке. Содержимое этих папок будет отображено секциями/группами в самой панели**. Подпапки внутри подпапок сканироваться не будут. Также *не рекомендуется* хранить 300+ картинок, потому что это всё сказывается на скорость прогрузки панели (размер файла не влияет).<br />
### Пример работы:
![Пример работы](https://raw.githubusercontent.com/Japanese-Schoolgirl/DiscordPlugin-CustomPanelForSendingPictures/main/Previews/WorkExample.gif)
Неотображённые в гифке выше изменения: улучшен дизайн кнопок, добавлена кнопка в панель картинок для открытия Главной папки, добавлена асинхронная подгрузка картинок на панель, добавлено отображение заглушки на превью картинки при проваленной загрузки локального или веб файла, добавлена опция для автоматического пропорционального масштабирования размера картинок из локальных или веб файлов к заданному размеру.<br />
Также был добавлен поиск по картинкам и продемонстрирован на гифке ниже:<br />
### Поисковая строка:
![Поисковая строка](https://raw.githubusercontent.com/Japanese-Schoolgirl/DiscordPlugin-CustomPanelForSendingPictures/main/Previews/SearchBar.gif)
### Меню настроек:
![Меню настроек](https://raw.githubusercontent.com/Japanese-Schoolgirl/DiscordPlugin-CustomPanelForSendingPictures/main/Previews/Settings_RU.png)

# Совместимость:
С нативными и любыми пользовательскими темами плагин должен быть полностью совместим, потому что использует стандартные переменные цветов Дискорда.<br />
Я пользуюсь [Powercord](https://github.com/powercord-org/powercord) и могу отслеживать проблемы возникающие только на нём. Тем не менее плагин у пользователей BetterDiscord должен работать исправно, потому что он сделан как плагин для [BetterDiscord](https://github.com/rauenzi/BetterDiscordApp).<br />
Плагин также использует [Zerebos' Plugin Library](https://rauenzi.github.io/BDPluginLibrary/release/0PluginLibrary.plugin.js) и [gifsicle](http://www.lcdf.org/gifsicle/).<br />
Работоспособность на операционных системах помимо Windows не проверялась, на других ОС, вероятно, некоторые функции могут не работать.<br />

# Установка:
1) Установите [Powercord](https://powercord.dev/installation) или [BetterDiscord](https://github.com/rauenzi/BBDInstaller/releases/latest/download/BandagedBD.exe). Для Powercord после установки вам также нужно будет установить [bdCompat](https://github.com/Juby210/bdCompat#installation) в папку плагинов Powercord (после этой установки появится раздел BetterDiscord Plugins в Powercord секции, также не забывайте что плагины отображаются в папках только после перезагрузки Дискорда);<br />
2) Перенесите [Zerebos' Plugin Library](https://rauenzi.github.io/BDPluginLibrary/release/0PluginLibrary.plugin.js) файл в папку с вашими плагинами;<br />
3) Перенесите "[.js](https://raw.githubusercontent.com/Japanese-Schoolgirl/DiscordPlugin-CustomPanelForSendingPictures/main/CustomPanelForSendingPictures.plugin.js)" файл плагина в папку с вашими плагинами;<br />
4) После включения этого плагина, в папке с плагином появится папка, в которую вам нужно перенести картинки, которые вы хотите использовать.<br />
<br />P.S. Плагин будет хранить информацию о содержимом в папке в файле CustomPanelForSendingPictures.settings.json, а вашу конфигурацию плагина в CustomPanelForSendingPictures.configuration.json (вы также можете удалить эти файлы, чтобы полностью сбросить все настройки).<br />

# Поддержка:
Если вы желаете помочь мне с этим кривоватым проектом, то обратите внимание на [TODO](https://github.com/Japanese-Schoolgirl/DiscordPlugin-CustomPanelForSendingPictures/blob/main/README_RU.md#%D0%BA%D0%BE%D0%BC%D0%BC%D1%83%D0%BD%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D1%8F), где указаны проблемы, которые я решаю на данный момент. Смотрите подробнее в разделе [Коммуникация](https://github.com/Japanese-Schoolgirl/DiscordPlugin-CustomPanelForSendingPictures/blob/main/README_RU.md#%D0%BA%D0%BE%D0%BC%D0%BC%D1%83%D0%BD%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D1%8F) о способах связи со мной.
Если вы хотите помочь мне денежкой и вы почему-то не использовали для этого кнопку "Sponsor", то вот мои реквизиты напрямую:<br />
https://donate.qiwi.com/payin/Schoolgirl<br />
https://www.donationalerts.com/r/JapaneseSchoolgirl<br />

# Коммуникация:
Я не принимаю неизвестные мне заявки в друзья, поэтому если вы захотите написать мне в DM Дискорда, то велик шанс что я вас не замечу. Вместо этого лучше используйте как средство коммуникации со мной GitHub или [Steam](https://steamcommunity.com/id/EternalSchoolgirl/) (вам необязательно добавляться ко мне, у меня открытая стена комментариев). У меня также есть [Discord сервер](https://discord.gg/nZMbKkw), но в нём ручная проверка каждого пользователя перед тем, как он получит разрешение на возможность писать и видеть большинство каналов для общения. Также вы можете попробовать написать мне на [Twitch](https://www.twitch.tv/EternalSchoolgirl), но это не самый удобный вариант.<br />

# Полезности:
- [Список изменений](https://github.com/Japanese-Schoolgirl/DiscordPlugin-CustomPanelForSendingPictures/blob/main/Changelog.md);<br />
- Для изменения размера картинок и их сжатия для меньшего размера в выбранной папке (для более оптимизации вашего листа с картинками) можно использовать [FastStone Photo Resizer](https://www.faststone.org/FSResizerDownload.htm) (лучше гифки этой программой не сжимать) или ей подобную;<br />
- Есть [архив](https://mega.nz/folder/c3YSmJYb#vF9iswDuT0YqOreDA9KL-g) с некоторыми сохранёнными в прошлом глобальными эмодзи, если вам нужно пополнить количество картинок.<br />

# TODO:
- ".sent" файлы не генерируются автоматически, это связано с проблемой получения ссылки из ID отправленного файла (потому что Dispatch возвращает только ID канала, но не ID сообщения и уж тем более не имеет в себе свойства ссылки на файл, а само сообщение не совпадает с информацией из события по размеру файла и иногда по названию);<br />
- Исправить опцию отправки сообщений перед отправкой файлов, которая отправляет сообщения без учёта разметки;<br />
- Несмотря на то, что вроде как часть с подгрузкой элементов на панель сделана асинхронно, всё ещё случается визуальный фриз (при том случайно, чаще всего после рестарта Дискорда). Попытка найти проблему в Perfomance через дебаг пока что успехом не увенчалась. Судя по всему проблема связана исключительно с большим количеством файлов. Также после минут 5 работы Дискорда подобные фризы исчезают;<br />
- Добавить поддержку пропорционального масштабирования размера картинок для **анимированных** файлов .png (.apng) и .webp (приоритет для этой задачи низкий, потому что Дискорд не умеет их корректно отображать на данный момент).<br />